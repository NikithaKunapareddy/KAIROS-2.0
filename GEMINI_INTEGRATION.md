# ðŸ¤– Gemini AI Integration - KAIROS 2.0

## Overview
KAIROS 2.0 now uses Google's **Gemini 2.0 Flash** (lowest cost model) to automatically generate educational content and AR overlays.

## Features

### 1. **Auto-Generated Educational Content (100+ Modules)**
- Dynamically generates comprehensive topics across Math, Physics, Chemistry, Biology, Geometry, and Engineering
- Each topic includes:
  - Detailed 200-300 word explanations
  - 2-5 formulas
  - Key concept bullet points
  - Real-world applications
  - Automatic Byju's platform links

### 2. **Dynamic AR Overlay Generation**
- Automatically creates AR overlays for ANY detected object
- Includes:
  - 6-8 anatomical/component labels with precise positioning
  - 2-3 process arrows showing flows and movements
  - 1-2 particle effects for molecular visualizations
  - Color-coded by type (green=biological, red=mechanical, blue=fluids)

## API Endpoints

### Generate Topics
```bash
GET /api/topics/generate?subject=Physics&count=20
```

**Response:**
```json
{
  "subject": "Physics",
  "topics": [
    {
      "name": "Newton's Laws",
      "category": "physics",
      "notes": "Detailed explanation...",
      "formulas": ["F=ma", "p=mv"],
      "difficulty": "intermediate",
      "key_points": ["..."],
      "applications": ["..."],
      "byjus_link": "https://byjus.com/search/?q=Newton's+Laws"
    }
  ],
  "total": 20
}
```

### Generate AR Overlays
```bash
GET /api/ar-overlays/generate/{object_name}
```

**Example:**
```bash
curl http://localhost:8000/api/ar-overlays/generate/leaf
```

## Configuration

### API Key
The Gemini API key is configured in `backend/main.py`:
```python
GEMINI_API_KEY = "AIzaSyChw-jCFIz3a25nOWDC4rD76alb8zVYvAk"
```

### Model Selection
Using **Gemini 2.0 Flash Experimental** for lowest cost:
```python
gemini_model = genai.GenerativeModel('gemini-2.0-flash-exp')
```

## Usage

### Frontend - Auto-Load Modules
The modules page automatically fetches 100+ topics from Gemini:
```typescript
// Tries Gemini first, falls back to static data
const response = await fetch('http://localhost:8000/api/topics/generate?count=100');
```

### Backend - AR Overlay Fallback
When a new object is detected:
1. Checks static `CONCEPT_DATABASE`
2. If not found, calls Gemini to generate overlays
3. Returns anatomical labels + visualizations

## Cost Optimization

- **Gemini 2.0 Flash**: Lowest cost model (~$0.075/1M input tokens)
- Content is generated on-demand and can be cached
- Static database used for common objects (plant, bicycle, bottle, ball, car)

## Example Output

### Physics Topic Generated by Gemini:
```json
{
  "name": "Quantum Entanglement",
  "category": "physics",
  "notes": "Quantum entanglement is a bizarre phenomenon where particles become linked...",
  "formulas": ["|ÏˆâŸ© = Î±|00âŸ© + Î²|11âŸ©", "Î”xÎ”p â‰¥ Ä§/2"],
  "difficulty": "advanced",
  "key_points": [
    "Particles are linked regardless of distance",
    "Measurement on one affects the other instantly"
  ],
  "applications": ["Quantum computing", "Quantum cryptography"]
}
```

### AR Overlays for "Leaf":
```json
{
  "concepts": [{
    "name": "Photosynthesis",
    "overlays": [
      {"type": "label", "text": "Blade", "position": "top", "color": "#00ff00"},
      {"type": "label", "text": "Petiole", "position": "middle", "color": "#88ff00"},
      {"type": "arrow", "label": "Hâ‚‚O Uptake", "direction": "down", "color": "#0088ff"},
      {"type": "particles", "label": "COâ‚‚", "movement": "random"}
    ]
  }]
}
```

## Testing

### Test Topic Generation:
```bash
cd backend
curl "http://localhost:8000/api/topics/generate?subject=Chemistry&count=5" | python3 -m json.tool
```

### Test AR Overlay Generation:
```bash
curl "http://localhost:8000/api/ar-overlays/generate/microscope" | python3 -m json.tool
```

## Benefits

âœ… **No manual content entry** - AI generates everything  
âœ… **100+ modules** automatically created  
âœ… **Universal AR support** - works for ANY object  
âœ… **Cost-effective** - using cheapest Gemini model  
âœ… **Rich educational content** - detailed notes, formulas, applications  
âœ… **Automatic Byju's integration** - links to external learning platform  

## Troubleshooting

### If topics array is empty:
1. Check backend logs for Gemini API errors
2. Verify API key is valid
3. Ensure `google-generativeai` package is installed:
   ```bash
   pip3 install google-generativeai
   ```

### If AR overlays don't show:
1. Check browser console for canvas rendering logs
2. Verify overlays array has `position` and `color` properties
3. Ensure detection bbox is valid

## Future Enhancements

- Cache generated content in database
- Add user feedback to improve AI prompts
- Support multiple languages
- Add quiz generation using Gemini
- Generate 3D model suggestions
